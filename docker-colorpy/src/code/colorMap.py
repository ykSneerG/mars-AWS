from typing import List, Tuple


class ColorMap:
    """
    A class to represent a color map for visualizing data.
    
    Attributes:
        max_value (float): The maximum value for the color map.
        gradient (list): A list of tuples representing the color map data.
    """

    def __init__(self, max_value: float, gradient: List[Tuple[float, Tuple[int, int, int]]]):
        self.max_value = max_value
        self.gradient = gradient


    def interpolate_color(self, c1: Tuple[int, int, int], c2: Tuple[int, int, int], t: float) -> Tuple[int, int, int]:
        """Linearly interpolates between two RGB colors."""
        return tuple(int(c1[i] + (c2[i] - c1[i]) * t) for i in range(3))

    def get_color(self, value: float) -> Tuple[int, int, int]:
        """Returns a color interpolated from the custom gradient based on the value."""
        # Normalize value
        v = min(max(value / self.max_value, 0), 1)

        # Find two stops surrounding the normalized value
        for i in range(len(self.gradient) - 1):
            p0, c0 = self.gradient[i]
            p1, c1 = self.gradient[i + 1]
            if p0 <= v <= p1:
                t = (v - p0) / (p1 - p0)
                return self.interpolate_color(c0, c1, t)

        # If value is beyond last stop, return last color
        return self.gradient[-1][1]
    
    def get_color_as_hex(self, value: float) -> str:
        """Returns the color as a hex string."""
        r, g, b = self.get_color(value)
        return f'#{r:02x}{g:02x}{b:02x}'


    map_barbie = [
        (0.0, (255, 255, 255)),
        (0.4, (255, 0, 70)),
        (0.7, (164, 0, 255)),
        (1.0, (50, 210, 255)),
    ]
    
    map_ample = [
        (0.0, (255, 255, 255)),
        (0.2, (21, 255, 0)),
        (0.5, (255, 190, 0)),
        (1.0, (255, 0, 80)),
    ]
    
    map_ample2 = [
        (0.0, (255, 255, 255)),
        (0.01, (255, 255, 255)),
        (0.5, (255, 190, 0)),
        (1.0, (255, 0, 80)),
    ]
    
    map_barbie2 = [
        (0.0, (255, 255, 255)),   # white
        (0.4, (255, 0, 70)),   # light pink
        (0.7, (164, 0, 255)),   # hot pink
        (1.0, (55, 25, 55)),       # dark blue
    ]
    
    map_barbie3 = [
        (0.0, (0, 255, 0)),   # white
        (0.3, (255, 255, 255)),   # white
        (0.5, (255, 0, 70)),   # light pink
        (1.0, (164, 0, 255)),   # hot pink
    ]
    
    
    map_plasma = [
        (0.0, (13, 8, 135)),    # dark blue
        (0.03225806451612903, (34, 6, 144)),  # blue
        (0.06451612903225806, (50, 5, 151)),  # light blue
        (0.0967741935483871, (64, 4, 157)),   # cyan
        (0.12903225806451613, (78, 2, 162)),  # light cyan
        (0.16129032258064516, (91, 1, 165)),  # greenish cyan
        (0.1935483870967742, (104, 0, 168)),  # green
        (0.22580645161290322, (117, 1, 168)), # yellow-green
        (0.25806451612903225, (129, 4, 167)), # yellow
        (0.29032258064516125, (141, 11, 165)),# orange-yellow
        (0.3225806451612903, (152, 20, 160)), # orange
        (0.3548387096774194, (163, 29, 154)), # red-orange
        (0.3870967741935484, (173, 38, 147)), # red
        (0.4193548387096774, (182, 48, 139)), # dark red
        (0.45161290322580644, (191, 57, 132)),# dark maroon
        (0.4838709677419355, (199, 66, 124)),# maroon
        (0.5161290322580645, (207, 76, 116)),# brownish maroon
        (0.5483870967741935, (214, 85, 109)),# brown
        (0.5806451612903225, (221, 94, 102)),# light brown
        (0.6129032258064516,(227 ,104 ,95)), # tan
        (0.6451612903225806,(233 ,114 ,88)), # light tan
        (0.6774193548387096,(238 ,124 ,81)), # beige
        (0.7096774193548387,(243 ,135 ,74)), # light beige
        (0.7419354838709677,(247 ,146 ,67)), # very light beige
        (0.7741935483870968,(250 ,157 ,59)), # off-white
        (0.8064516129032258,(252 ,169 ,53)), # light off-white
        (0.8387096774193548,(253 ,181 ,46)), # very light off-white
        (0.8709677419354839,(253 ,194 ,41)), # almost white
        (0.9032258064516129,(252 ,207 ,37)), # white
        (0.9354838709677419,(249 ,221 ,36)), # bright white
        (0.967741935483871,(245 ,235 ,39)),  # very bright white
        (1.0, (240, 249, 33))               # pure white
    ]
    
    map_viridis = [
        (0.0, (68, 1, 84)),
        (0.03225806451612903, (71, 13, 96)),
        (0.06451612903225806, (72, 25, 107)),
        (0.0967741935483871, (72, 36, 116)),
        (0.12903225806451613, (71, 46, 124)),
        (0.16129032258064516, (69, 56, 130)),
        (0.1935483870967742, (65, 66, 134)),
        (0.22580645161290322, (62, 75, 137)),
        (0.25806451612903225, (58, 84, 140)),
        (0.29032258064516125, (54, 93, 141)),
        (0.3225806451612903, (50, 101, 142)),
        (0.3548387096774194, (46, 109, 142)),
        (0.3870967741935484, (43, 117, 142)),
        (0.4193548387096774, (40, 125, 142)),
        (0.45161290322580644, (37, 133, 142)),
        (0.4838709677419355, (34, 140, 141)),
        (0.5161290322580645, (32, 148, 140)),
        (0.5483870967741935, (30, 156, 137)),
        (0.5806451612903225, (32, 163, 134)),
        (0.6129032258064516,(37 ,171 ,130)),
        (0.6451612903225806,(45 ,178 ,125)),
        (0.6774193548387096,(57 ,186 ,118)),
        (0.7096774193548387,(72 ,193 ,110)),
        (0.7419354838709677,(88 ,199 ,101)),
        (0.7741935483870968,(106 ,205 ,91)),
        (0.8064516129032258,(126 ,211 ,79)),
        (0.838709, (146 ,215 ,66)),
        (0.8709677419354839,(168 ,219 ,52)),
        (0.9032258064516129,(190 ,223 ,38)),
        (0.9354838709677419,(212 ,226 ,27)),
        (0.967741935483871,(233 ,228 ,26)),
        (1.0, (253, 231, 37))
    ]
      
    map_blackbody = [
        (0.0, (0, 0, 0)),          # Black
        (0.03225806451612903, (23, 8, 4)),  # Dark brown
        (0.06451612903225806, (35, 15, 9)), # Brown
        (0.0967741935483871, (47, 19, 13)), # Light brown
        (0.12903225806451613, (60, 21, 16)),# Tan
        (0.16129032258064516, (73, 24, 19)),# Light tan
        (0.1935483870967742, (87, 26, 21)), # Beige
        (0.22580645161290322, (101, 28, 23)),# Cream
        (0.25806451612903225, (115, 30, 25)),# Light cream
        (0.29032258064516125, (130, 31, 27)),# Off-white
        (0.3225806451612903, (145, 33, 30)),# White
        (0.3548387096774194, (160, 33, 32)),# Bright white
        (0.3870967741935484, (176, 34, 34)),# Very bright white
        (0.4193548387096774, (185, 47, 32)),# Almost white
        (0.45161290322580644, (193, 59, 30)),# Pale yellow
        (0.4838709677419355, (202, 71, 27)),# Light yellow
        (0.5161290322580645, (210, 82, 22)),# Yellow
        (0.5483870967741935, (218, 93, 16)),# Dark yellow
        (0.5806451612903225,(226 ,104 ,6)), # Orange-yellow
        (0.6129032258064516,(229 ,118 ,9)), # Orange
        (0.6451612903225806,(230 ,132 ,15)),# Dark orange
        (0.6774193548387096,(231 ,146 ,20)),# Light orange
        (0.7096774193548387,(232 ,159 ,25)),# Orange
        (0.7419354838709677,(233 ,172 ,30)),# Dark orange
        (0.7741935483870968,(233 ,185 ,35)),# Light orange
        (0.8064516129032258,(233 ,198 ,40)),# Orange
        (0.8387096774193548,(232 ,211 ,45)),# Dark orange
        (0.8709677419354839,(231 ,223 ,50)),# Light orange
        (0.9032258064516129,(236 ,233 ,89)),# Orange
        (0.9354838709677419,(246 ,240 ,148)),# Dark orange
        (0.967741935483871,(253 ,247 ,202)),# Light orange
        (1.0,(255 ,255 ,255))# Orange
    ]
    
    map_blackbody_inverse = [
        (0.0, (255, 255, 255)),  # White
        (0.03225806451612903, (253, 247, 202)),  # Light orange
        (0.06451612903225806, (246, 240, 148)),  # Dark orange
        (0.0967741935483871, (236, 233, 89)),   # Orange
        (0.12903225806451613, (231, 223, 50)),  # Light orange
        (0.16129032258064516, (232, 211, 45)),   # Dark orange
        (0.1935483870967742, (233, 198, 40)),    # Orange
        (0.22580645161290322, (233, 185, 35)),   # Light orange
        (0.25806451612903225, (233, 172, 30)),   # Orange
        (0.29032258064516125, (232, 159, 25)),   # Dark orange
        (0.3225806451612903, (230, 146, 20)),    # Light orange
        (0.3548387096774194, (229, 132, 15)),    # Orange
        (0.3870967741935484, (226, 118, 9)),     # Dark orange
        (0.4193548387096774, (218, 104, 6)),     # Orange-yellow
        (0.45161290322580644,(210 ,93 ,16)),     # Yellow
        (0.4838709677419355,(202 ,82 ,22)),      # Light yellow
        (0.5161290322580645,(193 ,71 ,27)),      # Pale yellow
        (0.5483870967741935,(185 ,59 ,30)),      # Almost white
        (0.5806451612903225,(176 ,47 ,32)),      # Very bright white
        (0.6129032258064516,(160 ,34 ,34)),      # Bright white
        (0.6451612903225806,(145 ,33 ,32)),      # White
        (0.6774193548387096,(130 ,31 ,27)),      # Off-white
        (0.7096774193548387,(115 ,30 ,25)),      # Light cream
        (0.7419354838709677,(101 ,28 ,23)),      # Cream
        (0.7741935483870968,(87 ,26 ,21)),       # Beige
        (0.8064516129032258,(73 ,24 ,19)),       # Light tan
        (0.8387096774193548,(60 ,21 ,16)),       # Tan
        (0.8709677419354839,(47 ,19 ,13)),       # Light brown
        (0.9032258064516129,(35 ,15 ,9)),        # Brown
        (0.9354838709677419,(23 ,8 ,4)),         # Dark brown
        (0.967741935483871, (0, 0, 0))            # Black
    ]
    
    map_kindlmann = [
        (0.0, (0, 0, 0)),
        (0.03225806451612903, (27, 1, 29)),
        (0.06451612903225806, (36, 3, 55)),
        (0.0967741935483871, (39, 4, 79)),
        (0.12903225806451613, (38, 5, 105)),
        (0.16129032258064516, (31, 6, 133)),
        (0.1935483870967742, (25, 8, 158)),
        (0.22580645161290322, (8, 21, 175)),
        (0.25806451612903225, (8, 46, 165)),
        (0.29032258064516125, (7, 64, 147)),
        (0.3225806451612903, (6, 78, 131)),
        (0.3548387096774194, (6, 90, 118)),
        (0.3870967741935484, (5, 101, 109)),
        (0.4193548387096774, (5, 112, 100)),
        (0.45161290322580644, (6, 122, 89)),
        (0.4838709677419355, (6, 132, 75)),
        (0.5161290322580645, (7, 142, 57)),
        (0.5483870967741935, (7, 152, 37)),
        (0.5806451612903225,(8 ,162 ,15)),
        (0.6129032258064516,(20 ,172 ,8)),
        (0.6451612903225806,(43 ,181 ,9)),
        (0.6774193548387096,(74 ,188 ,9)),
        (0.7096774193548387,(107 ,195 ,9)),
        (0.7419354838709677,(142 ,200 ,10)),
        (0.7741935483870968,(177 ,203 ,10)),
        (0.8064516129032258,(212 ,205 ,10)),
        (0.8387096774193548,(247 ,205 ,83)),
        (0.8709677419354839,(251 ,211 ,169)),
        (0.9032258064516129,(252 ,221 ,203)),
        (0.9354838709677419,(254 ,232 ,224)),
        (0.967741935483871,(254 ,244 ,240)),
        (1.0, (255, 255, 255))
    ]
    
    map_limepink = [
        (0.0, (255, 255, 255)),   # white
        (0.4, (0, 255, 0)),      # lime green
        (0.7, (164, 0, 255)),     # hot pink
        (1.0, (50, 210, 255))     # dark blue
    ]
    
    """ map_plasma_adapted = [
        (0.0,   (40, 30, 140)),   # aufgehellt von (13,8,135)
        (0.1,   (70, 20, 160)),   # mehr lila
        (0.2,   (100, 10, 170)),  # violett, satter
        (0.3,   (140, 30, 160)),  # Magenta-Ton
        (0.4,   (180, 60, 140)),  # rötlich-violett
        (0.5,   (210, 90, 120)),  # sattes orange
        (0.6,   (230, 120, 100)), # orange-pink
        (0.7,   (240, 150, 80)),  # orange-gelb
        (0.8,   (240, 180, 60)),  # gelblich
        (0.9,   (235, 210, 50)),  # leicht gedeckt
        (1.0,   (225, 235, 40)),  # nicht reinweiß
    ] """
    
    map_plasma_adapted = [
        (0.0,   (80, 50, 200)),    # kräftiges, helleres Violett
        (0.1,   (100, 40, 210)),   # knalliger Lila-Ton
        (0.2,   (130, 30, 200)),   # Magenta-Violett
        (0.3,   (160, 40, 180)),   # Magenta-Orange-Mix
        (0.4,   (190, 60, 150)),   # rötlicher Violett-Ton
        (0.5,   (215, 85, 120)),   # Orange-Rot
        (0.6,   (230, 115, 95)),   # Orange
        (0.7,   (240, 145, 75)),   # Gelb-Orange
        (0.8,   (240, 175, 60)),   # Gelb
        (0.9,   (235, 205, 50)),   # Gelbgrün
        (1.0,   (220, 230, 40)),   # abgedämpftes Gelb, kein reines Weiß
    ]
